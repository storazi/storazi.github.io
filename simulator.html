<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ—¿ ë¯¸ê¶ ë“€ì–¼ ì‹œë®¬ë ˆì´í„°</title>
<style>
:root {
  --bg:#0b1426;--panel:#0f1e3a;--soft:#11234a;--ring:#1e396e;
  --ink:#eaf2ff;--muted:#a9b5cc;--yellow:#ffd447;
  --pet-bg:#122850;--char-bg:#0f1f3f;
}
body{background:var(--bg);color:var(--ink);font-family:"Pretendard",sans-serif;margin:0;padding:20px}
h1{color:var(--yellow);margin-bottom:6px;cursor:pointer}
.card{
  background:linear-gradient(180deg,var(--panel),var(--soft));
  border:1px solid var(--ring);border-radius:14px;
  padding:16px;margin-bottom:16px;box-shadow:0 6px 16px rgba(0,0,0,0.25)
}
input,select,button{
  border-radius:8px;border:1px solid var(--ring);
  background:#0a1732;color:var(--ink);
  padding:6px;font-size:13px;box-sizing:border-box
}
button{cursor:pointer;font-weight:700;transition:.15s}
button:hover{opacity:.9}
.btn{background:var(--yellow);color:#1a1300;border:none}
.team{display:flex; gap:20px; justify-content:space-between;}
.unit-col{flex:1}
.unit-row{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(70px,1fr));
  gap:6px;margin-bottom:6px;
  padding:6px;background:var(--char-bg);border-radius:8px;
}
.unit-row.pet{background:var(--pet-bg)}
#log{
  width:100%;height:340px;background:#0a1225;border:1px solid var(--ring);
  border-radius:8px;font-family:"JetBrains Mono",monospace;
  font-size:13px;line-height:1.45;overflow-y:auto;white-space:pre-wrap;
  word-break:break-all;padding:10px;
}
#log .turn {color:var(--yellow);font-weight:700;margin-top:6px;}
#log .unitA {color:#68c3ff;font-weight:600;}
#log .unitB {color:#ff7f7f;font-weight:600;}
#log .skill {color:#ffd447;font-weight:600;}
#log .hit {color:#7df58a;}
#log .hp {color:#a9b5cc;}
.turnBlock {border-top:1px solid var(--ring);margin-top:8px;padding-top:4px;}
footer{text-align:center;color:var(--muted);font-size:13px;margin-top:20px}
</style>
</head>
<body>

<h1 id="title">ğŸ—¿ ë¯¸ê¶ ë“€ì–¼ ì‹œë®¬ë ˆì´í„°</h1>
<p class="sub">10vs10 ï½œ ìë™ / ìˆ˜ë™ ï½œ ì§€>ìˆ˜>í™”>í’>ì§€</p>

<div class="card">
  <button class="btn" id="homeBtn">ğŸ  í™ˆ</button>
  <button class="btn" id="clearBtn">ğŸ§¹ ë¡œê·¸ í´ë¦¬ì–´</button>
  <label><input type="radio" name="mode" value="auto" checked> ìë™</label>
  <label><input type="radio" name="mode" value="manual"> ìˆ˜ë™</label>
  <button class="btn" id="fillBtn" style="float:right;margin-left:8px;">ìƒ˜í”Œ ì±„ìš°ê¸°</button>
  <button class="btn" id="runBtn" style="float:right;">â–¶ ì‹¤í–‰</button>
  <button class="btn" id="nextBtn" style="display:none;float:right;">â­ ë‹¤ìŒ í„´</button>
</div>

<section class="card">
  <h3>âš”ï¸ Team A / ğŸ›¡ï¸ Team B</h3>
  <div class="team">
    <div class="unit-col" id="teamA"></div>
    <div class="unit-col" id="teamB"></div>
  </div>
</section>

<section class="card" id="orderPanel" style="display:none">
  <h3>ğŸ§  ì˜¤ë” ì…ë ¥</h3>
  <div class="team">
    <div class="unit-col">
      <h4>âš”ï¸ Team A</h4>
      <table><thead><tr><th>í–‰ë™ì</th><th>ê¸°ìˆ </th><th>ëŒ€ìƒ</th></tr></thead><tbody id="orderBodyA"></tbody></table>
    </div>
    <div class="unit-col">
      <h4>ğŸ›¡ï¸ Team B</h4>
      <table><thead><tr><th>í–‰ë™ì</th><th>ê¸°ìˆ </th><th>ëŒ€ìƒ</th></tr></thead><tbody id="orderBodyB"></tbody></table>
    </div>
  </div>
</section>

<section class="card">
  <h3>ğŸ“œ ì „íˆ¬ ë¡œê·¸</h3>
  <div id="log"></div>
</section>

<footer>Â© 2025 storazi ï½œ MIT License</footer>

<script>
document.addEventListener("DOMContentLoaded",()=>{

// ===== ë²„íŠ¼ =====
document.getElementById("title").addEventListener("click",()=>location.href="index.html");
document.getElementById("homeBtn").addEventListener("click",()=>location.href="index.html");
document.getElementById("clearBtn").addEventListener("click",()=>{logClear();logLine("ğŸ§¹ ë¡œê·¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");});

// ===== ë¡œê·¸ =====
const logEl=document.getElementById("log");
function logClear(){logEl.innerHTML="";}
function logLine(html){logEl.insertAdjacentHTML("beforeend",html+"<br>");logEl.scrollTop=logEl.scrollHeight;}
function logTurn(turn,mode){logLine(`<div class="turnBlock"><div class="turn">ğŸŒ€ --- í„´ ${turn} (${mode}) ---</div>`);}
function logAction(a,t,s,d,h){
  const atk=a.team==="A"?"unitA":"unitB";
  const tgt=t.team==="A"?"unitA":"unitB";
  const icon=s==="ë°©ì–´"?"ğŸ›¡ï¸":s==="ê°€ë“œë¸Œë ˆì´í¬"?"ğŸ’¥":s==="ë°°ìˆ˜ì˜ì§„2"?"ğŸ”¥":s==="ë‹¤êµ´"?"âš”ï¸":"âš”ï¸";
  logLine(`<span class="${atk}">${a.name}</span> â–¶ <span class="skill">${icon} ${s}</span> â†’ <span class="${tgt}">${t.name}</span> <span class="hit">${d?d+" ë°ë¯¸ì§€":""}</span> <span class="hp">(HP:${h})</span>`);
}
function logEndTurn(a,b){logLine(`<div class="hp">ì”ì¡´: <span class="unitA">A=${a}</span> / <span class="unitB">B=${b}</span></div><hr></div>`);}

// ===== ë°ì´í„° =====
const elems=["ì§€","ìˆ˜","í™”","í’"];
const skills=["ê³µê²©","ë°©ì–´","ê°€ë“œë¸Œë ˆì´í¬","ë°°ìˆ˜ì˜ì§„2","ë‹¤êµ´"];

class Unit{
  constructor(t,ty,n,a,d,s,h,e){
    this.team=t;this.type=ty;this.no=n;
    this.name=`${t}${ty[0]}${n}`;
    this.atk=+a;this.def=+d;this.spd=+s;
    this.hp=+h;this.max_hp=h;
    this.elem=e;this.alive=true;
  }
  isAlive(){return this.alive&&this.hp>0;}
  take(d){
    this.hp-=d;
    if(this.hp<=0&&this.alive){
      this.alive=false;
      const cls=this.team==='A'?'unitA':'unitB';
      const idPrefix=`${this.team}_${this.type}_${this.no}`;
      if(this.hp<=-this.max_hp*0.5){
        logLine(`<span class="${cls}">${this.name}</span> ğŸ’€ ì „íˆ¬ì´íƒˆ!`);
        disableInputs(idPrefix,"ğŸ’€ ì „íˆ¬ì´íƒˆ");
      }else{
        logLine(`<span class="${cls}">${this.name}</span> âŒ ì „íˆ¬ë¶ˆëŠ¥!`);
        disableInputs(idPrefix,"âš°ï¸ ì‚¬ë§");
      }
      this.hp=Math.max(0,this.hp);

      // ìºë¦­í„° ì£½ìœ¼ë©´ í˜íŠ¸ ë™ë°˜ì²˜ë¦¬
      if(this.type==="ìºë¦­í„°"){
        const pet=state.units.find(x=>x.team===this.team&&x.type==="í˜íŠ¸"&&x.no===this.no);
        if(pet&&pet.isAlive()){
          const petPrefix=`${pet.team}_${pet.type}_${pet.no}`;
          if(this.hp<=-this.max_hp*0.5){
            pet.alive=false;
            logLine(`<span class="${cls}">${pet.name}</span> ğŸ’€ (${this.name}ê³¼ í•¨ê»˜ ì „íˆ¬ì´íƒˆ)`);
            disableInputs(petPrefix,"ğŸ’€ ë™ë°˜ì´íƒˆ");
          }else{
            pet.alive=false;
            logLine(`<span class="${cls}">${pet.name}</span> âš« (${this.name} ì‚¬ë§ìœ¼ë¡œ ë¬´ë ¥í™”)`);
            disableInputs(petPrefix,"âš« ë¬´ë ¥í™”");
          }
        }
      }
    }
  }
}

// ===== ë³´ì¡°í•¨ìˆ˜ =====
function disableInputs(prefix,text){
  ["atk","def","spd","hp","elem"].forEach(id=>{
    const el=document.getElementById(`${prefix}_${id}`);
    if(el){el.disabled=true;el.style.opacity="0.5";el.style.background="#1a1a1a";el.style.color="#777";
      if(id==="hp")el.value=text;}
  });
}

function elemAdv(a,b){
  const adv={ì§€:"ìˆ˜",ìˆ˜:"í™”",í™”:"í’",í’:"ì§€"};
  if(a===b)return 1;
  if(adv[a]===b)return 1.2;
  if(adv[b]===a)return 0.8;
  return 1;
}

function buildTeamHTML(team){
  const host=document.getElementById("team"+team);
  host.innerHTML="";
  for(let i=1;i<=5;i++){
    for(const type of["ìºë¦­í„°","í˜íŠ¸"]){
      const row=document.createElement("div");
      row.className="unit-row"+(type==="í˜íŠ¸"?" pet":"");
      row.innerHTML=`
        <input id="${team}_${type}_${i}_atk" placeholder="ê³µ">
        <input id="${team}_${type}_${i}_def" placeholder="ë°©">
        <input id="${team}_${type}_${i}_spd" placeholder="ìˆœ">
        <input id="${team}_${type}_${i}_hp" placeholder="ì²´">
        <select id="${team}_${type}_${i}_elem">${elems.map(e=>`<option>${e}</option>`).join("")}</select>
        <select disabled><option>${type}</option></select>`;
      host.appendChild(row);
    }
  }
}

function readUnits(){
  const arr=[];
  for(const t of["A","B"])for(let i=1;i<=5;i++)for(const k of["ìºë¦­í„°","í˜íŠ¸"]){
    const atk=+document.getElementById(`${t}_${k}_${i}_atk`).value||150;
    const def=+document.getElementById(`${t}_${k}_${i}_def`).value||120;
    const spd=+document.getElementById(`${t}_${k}_${i}_spd`).value||150;
    const hp=+document.getElementById(`${t}_${k}_${i}_hp`).value||800;
    const elem=document.getElementById(`${t}_${k}_${i}_elem`).value;
    arr.push(new Unit(t,k,i,atk,def,spd,hp,elem));
  }
  return arr;
}

function fillSample(){
  for(const T of["A","B"])for(let i=1;i<=5;i++)for(const K of["ìºë¦­í„°","í˜íŠ¸"]){
    document.getElementById(`${T}_${K}_${i}_atk`).value=140+(K==="ìºë¦­í„°"?20:0);
    document.getElementById(`${T}_${K}_${i}_def`).value=120+(K==="í˜íŠ¸"?20:0);
    document.getElementById(`${T}_${K}_${i}_spd`).value=150+(K==="ìºë¦­í„°"?10:-10);
    document.getElementById(`${T}_${K}_${i}_hp`).value=900+(K==="í˜íŠ¸"?100:0);
    document.getElementById(`${T}_${K}_${i}_elem`).value=elems[(i-1)%4];
  }
  logLine("âœ” ìƒ˜í”Œ ìŠ¤íƒ¯ ì±„ì›Œì§");
}

// ===== ì „íˆ¬ =====
function damageCalc(a,d,ratio=1){return Math.max(1,Math.floor((a-d/2)*ratio*(0.9+Math.random()*0.2)));}
function pickEnemy(u){const list=state.units.filter(x=>x.team!==u.team&&x.isAlive());return list[Math.floor(Math.random()*list.length)]}
function autoSkill(){return skills[Math.floor(Math.random()*skills.length)]}
function doAction(u,t,skill){
  if(!u.isAlive()||!t||!t.isAlive())return;
  if(skill==="ë°©ì–´"){logAction(u,t,skill,0,u.hp);return;}
  if(skill==="ë‹¤êµ´"){
    const allies=state.units.filter(x=>x.team===u.team&&x!==u&&x.isAlive()).slice(0,2);
    for(const a of[u,...allies]){
      const dmg=damageCalc(a.atk,t.def,1.0);
      t.take(dmg);
      logAction(a,t,"ë‹¤êµ´",dmg,t.hp);
      if(!t.isAlive())return;
    }
    return;
  }
  let ratio=1;if(skill==="ê°€ë“œë¸Œë ˆì´í¬")ratio=1.2;if(skill==="ë°°ìˆ˜ì˜ì§„2")ratio=1.5;
  const dmg=damageCalc(u.atk,t.def,ratio*elemAdv(u.elem,t.elem));
  t.take(dmg);
  logAction(u,t,skill,dmg,t.hp);
}

// ===== ì˜¤ë” =====
function buildOrders(){
  const bodyA=document.getElementById("orderBodyA"),bodyB=document.getElementById("orderBodyB");
  bodyA.innerHTML="";bodyB.innerHTML="";
  for(const u of state.units){
    const disabled=u.isAlive()?"":"disabled";
    const html=`<tr>
      <td>${u.name}</td>
      <td><select id="skill_${u.name}" ${disabled}>${skills.map(s=>`<option>${s}</option>`).join("")}</select></td>
      <td><select id="target_${u.name}" ${disabled}>${state.units.filter(x=>x.team!==u.team&&x.isAlive()).map(x=>`<option>${x.name}</option>`).join("")}</select></td>
    </tr>`;
    (u.team==="A"?bodyA:bodyB).insertAdjacentHTML("beforeend",html);
  }
}

// ===== í„´ =====
function runTurn(mode){
  logTurn(state.turn,mode);
  const order=state.units.filter(u=>u.isAlive()).sort((a,b)=>b.spd-a.spd);
  for(const u of order){
    let skill,target;
    if(mode==="auto"){skill=autoSkill();target=pickEnemy(u);}
    else{
      const sEl=document.getElementById(`skill_${u.name}`);
      const tEl=document.getElementById(`target_${u.name}`);
      if(!sEl||!tEl||sEl.disabled)continue;
      skill=sEl.value;const tname=tEl.value;
      target=state.units.find(x=>x.name===tname);
    }
    if(target)doAction(u,target,skill);
  }
  const a=state.units.filter(x=>x.team==="A"&&x.isAlive()).length;
  const b=state.units.filter(x=>x.team==="B"&&x.isAlive()).length;
  logEndTurn(a,b);
  if(a===0||b===0){
    logLine(`ğŸ ì¢…ë£Œ: ${a>b?"A":"B"}íŒ€ ìŠ¹ë¦¬!`);
    document.getElementById("nextBtn").style.display="none";
    document.getElementById("orderPanel").style.display="none";
    document.getElementById("runBtn").style.display="inline-block";
    return true;
  }
  state.turn++;
  return false;
}

// ===== ì‹¤í–‰ =====
const state={turn:1,units:[]};
buildTeamHTML("A");
buildTeamHTML("B");
document.getElementById("fillBtn").onclick=fillSample;
document.getElementById("runBtn").onclick=()=>{
  const mode=document.querySelector('input[name="mode"]:checked').value;
  logClear();
  state.turn=1;
  state.units=readUnits();
  if(mode==="manual"){
    document.getElementById("orderPanel").style.display="block";
    document.getElementById("nextBtn").style.display="inline-block";
    document.getElementById("runBtn").style.display="none";
    buildOrders();
    logLine("â–¶ ìˆ˜ë™ëª¨ë“œ ì‹œì‘");
  }else{
    logLine("â–¶ ìë™ëª¨ë“œ ì‹œì‘");
    for(let i=0;i<10&&!runTurn("auto");i++);
  }
};
document.getElementById("nextBtn").onclick=()=>{
  runTurn("manual");
  buildOrders();
};
});
</script>
</body>
</html>
