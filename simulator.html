<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ—¿ ë¯¸ê¶ ë“€ì–¼ ì‹œë®¬ë ˆì´í„°</title>

<style>
:root {
  --bg:#0b1426; --panel:#0f1e3a; --soft:#11234a;
  --ring:#1e396e; --ink:#eaf2ff; --muted:#a9b5cc; --yellow:#ffd447;
  --pet-bg:#122850; --char-bg:#0f1f3f;
}
body {
  background:var(--bg); color:var(--ink);
  font-family:"Pretendard",sans-serif;
  margin:0; padding:20px;
}
h1 { color:var(--yellow); margin-bottom:6px; }
p.sub { color:var(--muted); font-size:13px; margin:0 0 16px; }

.card {
  background:linear-gradient(180deg,var(--panel),var(--soft));
  border:1px solid var(--ring); border-radius:14px;
  padding:16px; width:100%;
  margin-bottom:20px; box-shadow:0 6px 16px rgba(0,0,0,0.25);
  box-sizing:border-box;
}
.grid2{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;}
.grid3{display:grid;grid-template-columns:200px 200px auto;align-items:end;gap:12px;width:100%;}
.mini{font-size:12px;color:var(--muted);margin-bottom:4px;}
.hr{height:1px;background:linear-gradient(90deg,transparent,var(--ring),transparent);margin:10px 0;border:none;}

input,select,button,textarea{
  border-radius:8px;border:1px solid var(--ring);
  background:#0a1732;color:var(--ink);padding:6px;font-size:13px;box-sizing:border-box;
}
button{cursor:pointer;font-weight:700;transition:all .15s;}
button:hover{opacity:.9}
.btn{background:var(--yellow);color:#1a1300;border:none;}
.btn-ghost{background:transparent;color:var(--ink);border:1px solid var(--ring);}
.tabs{display:flex;gap:8px;margin-bottom:12px;}
.tab{flex:1;padding:10px;text-align:center;background:#0a1732;border:1px solid var(--ring);border-radius:10px;cursor:pointer;}
.tab:hover{background:#152548;}
.active{background:var(--yellow);color:#1a1300;font-weight:800;}

.log{
  height:220px;width:100%;font-family:monospace;line-height:1.25;
  background:#09172b;border:1px solid var(--ring);border-radius:8px;
  resize:none;overflow-y:auto;box-sizing:border-box;
  white-space:pre-wrap;word-break:break-all;scroll-behavior:smooth;
}
.team-column{display:flex;flex-direction:column;gap:4px;}
.unit-pair { position: relative; margin-bottom: 4px; }
.unit-label {font-size:12px;color:var(--yellow);font-weight:700;margin:2px 0 3px 3px;}
.unit-row {
  display:grid;
  grid-template-columns:repeat(9,1fr);
  gap:4px; align-items:center; border-radius:6px; padding:4px;
  width:100%; box-sizing:border-box;
}
.unit-row input,.unit-row select{width:100%;text-align:center;padding:4px;box-sizing:border-box;}
.unit-char { background:var(--char-bg); border-left:3px solid var(--yellow); }
.unit-pet  { background:var(--pet-bg);  border-left:3px solid var(--yellow); }
.pair-line { position:absolute; left:0; width:2px; top:20px; bottom:-4px; background:var(--yellow); border-radius:1px; opacity:0.5; }

/* ìŠ¬ë¼ì´ë” */
.slider-row { display:flex; align-items:center; gap:10px; margin-bottom:10px; }
.slider-row label { width:140px; }
.slider-row input[type=range] { flex:1; accent-color: var(--yellow); }
.slider-row span { width:50px; text-align:right; }

/* âœ… í•˜ë‹¨ ê³ ì • í‘¸í„° */
footer {
  position: fixed;
  bottom: 10px;
  width: 100%;
  text-align: center;
  color: var(--muted);
  font-size: 13px;
}
footer a { color: var(--yellow); text-decoration: none; }
footer a:hover { text-decoration: underline; }
</style>
</head>

<body>
<h1>ğŸ—¿ ë¯¸ê¶ ë“€ì–¼ ì‹œë®¬ë ˆì´í„°</h1>
<p class="sub">ë¯¸ê¶ ë¶€ì¡±ì„ ìœ„í•œ ìë£Œì…ë‹ˆë‹¤. ë¬´ë‹¨ ë°°í¬ ê¸ˆì§€í•©ë‹ˆë‹¤.</p>

<!-- ===== í™•ë¥  ì¡°ì • ìŠ¬ë¼ì´ë” ===== -->
<section class="card">
  <div class="slider-row"><label>ê³µê²© í™•ë¥  (%)</label><input type="range" id="rateAttack" min="0" max="100" value="60" oninput="updateRateValue(this)"><span id="val_rateAttack">60%</span></div>
  <div class="slider-row"><label>ë°©ì–´ í™•ë¥  (%)</label><input type="range" id="rateDef" min="0" max="100" value="15" oninput="updateRateValue(this)"><span id="val_rateDef">15%</span></div>
  <div class="slider-row"><label>ê°€ë“œë¸Œë ˆì´í¬ í™•ë¥  (%)</label><input type="range" id="rateGB" min="0" max="100" value="10" oninput="updateRateValue(this)"><span id="val_rateGB">10%</span></div>
  <div class="slider-row"><label>ë°°ìˆ˜ì˜ì§„2 í™•ë¥  (%)</label><input type="range" id="rateFormation" min="0" max="100" value="10" oninput="updateRateValue(this)"><span id="val_rateFormation">10%</span></div>
  <div class="slider-row"><label>ë‹¤êµ´ í™•ë¥  (%)</label><input type="range" id="rateMulti" min="0" max="100" value="5" oninput="updateRateValue(this)"><span id="val_rateMulti">5%</span></div>
</section>

<section class="card">
  <div class="grid2">
    <div><div class="mini">A ìŠ¹ë¥ </div><div id="kpiA" style="font-weight:900;font-size:22px">-</div></div>
    <div><div class="mini">B ìŠ¹ë¥ </div><div id="kpiB" style="font-weight:900;font-size:22px">-</div></div>
  </div>
  <div class="hr"></div>
  <label>ì „íˆ¬ ë¡œê·¸</label>
  <textarea id="log" class="log" readonly placeholder="ì „íˆ¬ ë¡œê·¸ ì¶œë ¥ ì˜ì—­"></textarea>
</section>

<!-- ===== íƒ­ ì„¹ì…˜ ===== -->
<section class="card">
  <div class="tabs">
    <button class="tab active" id="tab5v5" onclick="showTab('pane5v5')">10vs10</button>
    <button class="tab" id="tabElem" onclick="showTab('paneElem')">ì†ì„± ìƒì„±í‘œ</button>
  </div>

  <div id="pane5v5">
    <div class="mini">âš”ï¸ ì‹œë®¬ë ˆì´ì…˜ ì˜µì…˜</div>
    <div class="card" style="padding:10px;">
      <div class="grid3">
        <div><label>ì‹œë®¬ë ˆì´ì…˜ íšŸìˆ˜</label><input id="simN_5v5" value="100"></div>
        <div><label>ëœë¤ìš”ì†Œ(%)</label><input id="rngVar5" value="20"></div>
        <div style="display:flex;align-items:end;justify-content:flex-end;gap:8px;width:100%;margin-top:4px;">
          <button class="btn-ghost" id="fillTeams">ìƒ˜í”Œ ì±„ìš°ê¸°</button>
          <button class="btn" id="run5v5">ğŸ›¡ï¸ ì „íˆ¬ ì‹œì‘</button>
          <button class="btn-ghost" id="resetResult" type="button" onclick="resetResult()">ğŸ§¹ ê²°ê³¼ ì´ˆê¸°í™”</button>
        </div>
      </div>
    </div>

    <div class="hr"></div>
    <div class="mini">âš”ï¸ Team A</div>
    <div class="card" style="padding:12px;"><div id="teamA" class="team-column"></div></div>

    <div class="hr"></div>
    <div class="mini">ğŸ›¡ï¸ Team B</div>
    <div class="card" style="padding:12px;"><div id="teamB" class="team-column"></div></div>
  </div>

  <div id="paneElem" style="display:none">
    <div class="mini">ì†ì„± ìƒì„± ë°°ìœ¨ (1.2 = +20%)</div>
    <table id="elemTable">
      <thead><tr><th></th><th>ì§€</th><th>ìˆ˜</th><th>í™”</th><th>í’</th></tr></thead>
      <tbody>
        <tr><th>ì§€</th><td><input id="adv_ì§€_ì§€" value="1.0"></td><td><input id="adv_ì§€_ìˆ˜" value="0.8"></td><td><input id="adv_ì§€_í™”" value="1.2"></td><td><input id="adv_ì§€_í’" value="1.0"></td></tr>
        <tr><th>ìˆ˜</th><td><input id="adv_ìˆ˜_ì§€" value="1.2"></td><td><input id="adv_ìˆ˜_ìˆ˜" value="1.0"></td><td><input id="adv_ìˆ˜_í™”" value="0.8"></td><td><input id="adv_ìˆ˜_í’" value="1.0"></td></tr>
        <tr><th>í™”</th><td><input id="adv_í™”_ì§€" value="1.0"></td><td><input id="adv_í™”_ìˆ˜" value="1.2"></td><td><input id="adv_í™”_í™”" value="1.0"></td><td><input id="adv_í™”_í’" value="0.8"></td></tr>
        <tr><th>í’</th><td><input id="adv_í’_ì§€" value="0.8"></td><td><input id="adv_í’_ìˆ˜" value="1.0"></td><td><input id="adv_í’_í™”" value="1.2"></td><td><input id="adv_í’_í’" value="1.0"></td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- ===== ìŠ¤í¬ë¦½íŠ¸ ===== -->
<script>
function updateRateValue(slider){
  const span=document.getElementById("val_"+slider.id);
  span.textContent=slider.value+"%";
}

function showTab(id){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('tab'+id.replace('pane','')).classList.add('active');
  document.querySelectorAll('#pane5v5,#paneElem').forEach(p=>p.style.display='none');
  document.getElementById(id).style.display='block';
}

/* ì´í•˜ ì‹œë®¬ë ˆì´ì…˜ ì½”ë“œ ë™ì¼ */
class Unit {
  constructor(team,name,atk,def,spd,hp,elem){
    this.team=team;this.name=name;this.atk=atk;this.def=def;this.spd=spd;
    this.hp=hp;this.max_hp=hp;this.elem=elem;this.alive=true;this.isGuarding=false;this.guardBreak=false;
  }
  isAlive(){return this.hp>0;}
  takeDamage(d){this.hp=Math.max(0,this.hp-d);if(this.hp<=0)this.alive=false;}
}

function readElementAdv(){
  const attrs=['ì§€','ìˆ˜','í™”','í’'];const adv={};
  attrs.forEach(a=>{adv[a]={};attrs.forEach(b=>{
    adv[a][b]=parseFloat(document.getElementById(`adv_${a}_${b}`)?.value)||1.0;
  })});
  return adv;
}

function blendedRatio(att,def,adv){
  const atkSum=Object.values(att).reduce((a,b)=>a+b,0)||1;
  const defSum=Object.values(def).reduce((a,b)=>a+b,0)||1;
  let total=0;
  for(const [ae,av]of Object.entries(att))
    for(const [de,dv]of Object.entries(def))
      total+=(adv[ae]?.[de]||1.0)*(av/atkSum)*(dv/defSum);
  return total;
}

function resetResult(){
  const log=document.getElementById("log");
  const kA=document.getElementById("kpiA");
  const kB=document.getElementById("kpiB");
  if(log)log.value="";
  if(kA)kA.innerText="-";
  if(kB)kB.innerText="-";
  if(log)log.scrollTop=0;
}

function getRandomAction(){
  const r=Math.random()*100;
  const a=parseFloat(document.getElementById("rateAttack").value)||0;
  const d=parseFloat(document.getElementById("rateDef").value)||0;
  const gb=parseFloat(document.getElementById("rateGB").value)||0;
  const fo=parseFloat(document.getElementById("rateFormation").value)||0;
  const mu=parseFloat(document.getElementById("rateMulti").value)||0;
  if(r<a)return"ê³µê²©";
  if(r<a+d)return"ë°©ì–´";
  if(r<a+d+gb)return"ê°€ë“œë¸Œë ˆì´í¬";
  if(r<a+d+gb+fo)return"ë°°ìˆ˜ì˜ì§„2";
  return"ë‹¤êµ´";
}

function simulate5vs5(){
  const adv=readElementAdv();
  const rng=parseFloat(document.getElementById("rngVar5").value)/100;
  const n=parseInt(document.getElementById("simN_5v5").value);
  function readTeam(pref,team){
    const arr=[];
    for(let i=0;i<10;i++){
      const atk=parseInt(document.getElementById(`${pref}_atk_${i}`).value)||0;
      const def=parseInt(document.getElementById(`${pref}_def_${i}`).value)||0;
      const spd=parseInt(document.getElementById(`${pref}_spd_${i}`).value)||0;
      const hp=parseInt(document.getElementById(`${pref}_hp_${i}`).value)||0;
      const e1=document.getElementById(`${pref}_e1_${i}`).value;
      const e1v=parseFloat(document.getElementById(`${pref}_e1v_${i}`).value)||0;
      const e2=document.getElementById(`${pref}_e2_${i}`).value;
      const e2v=parseFloat(document.getElementById(`${pref}_e2v_${i}`).value)||0;
      const elem={};if(e1v>0)elem[e1]=e1v;if(e2v>0)elem[e2]=e2v;
      arr.push(new Unit(team,`${team}${i+1}`,atk,def,spd,hp,elem));
    }
    return arr;
  }

  const teamA=readTeam("A","A"), teamB=readTeam("B","B");
  let aWin=0,bWin=0,log=[];
  for(let sim=0;sim<n;sim++){
    const A=teamA.map(u=>new Unit(u.team,u.name,u.atk,u.def,u.spd,u.max_hp,structuredClone(u.elem)));
    const B=teamB.map(u=>new Unit(u.team,u.name,u.atk,u.def,u.spd,u.max_hp,structuredClone(u.elem)));
    let turn=1;
    while(A.some(u=>u.isAlive())&&B.some(u=>u.isAlive())){
      log.push(`--- í„´ ${turn} ---`);
      const all=[...A,...B].filter(u=>u.isAlive()).sort((x,y)=>y.spd-x.spd);
      for(const u of all){
        if(!u.isAlive())continue;
        const enemies=(u.team==="A"?B:A).filter(e=>e.isAlive());
        if(!enemies.length)break;
        const action=getRandomAction();
        let target=enemies[Math.floor(Math.random()*enemies.length)];
        let atk=u.atk,def=target.def;
        let ratio=blendedRatio(u.elem,target.elem,adv);
        let dmg=0;
        if(action==="ë°©ì–´"){u.isGuarding=true;log.push(`[í„´${turn}] ${u.name} â–¶ ë°©ì–´`);continue;}
        if(action==="ê°€ë“œë¸Œë ˆì´í¬"){u.guardBreak=true;log.push(`[í„´${turn}] ${u.name} â–¶ ê°€ë“œë¸Œë ˆì´í¬`);}
        if(action==="ë°°ìˆ˜ì˜ì§„2"){atk*=1.5;u.def*=0.5;log.push(`[í„´${turn}] ${u.name} â–¶ ë°°ìˆ˜ì˜ì§„2`);}
        dmg=Math.max(1,Math.floor((atk-def)*ratio*(1+(Math.random()*2-1)*rng)));
        if(target.isGuarding&&!u.guardBreak)dmg*=0.5;
        target.takeDamage(dmg);
        log.push(`[í„´${turn}] ${u.name}(${action}) â†’ ${target.name} ${dmg} ë°ë¯¸ì§€ (HP ${target.hp})`);
        u.isGuarding=false;u.guardBreak=false;
      }
      turn++;if(turn>200)break;
    }
    const aliveA=A.filter(u=>u.isAlive()).length;
    const aliveB=B.filter(u=>u.isAlive()).length;
    if(aliveA>aliveB)aWin++;else if(aliveB>aliveA)bWin++;
    else {
      const sumA=A.reduce((acc,u)=>acc+u.hp,0);
      const sumB=B.reduce((acc,u)=>acc+u.hp,0);
      if(sumA>=sumB)aWin++;else bWin++;
    }
  }
  const aRate=(aWin/n*100).toFixed(1);
  const bRate=(bWin/n*100).toFixed(1);
  document.getElementById("kpiA").innerText=aRate+"%";
  document.getElementById("kpiB").innerText=bRate+"%";
  document.getElementById("log").value=log.slice(-300).join("\n")+`\n\nê²°ê³¼: A ${aRate}% | B ${bRate}%`;
}

function buildTeams(){
  const attrs=['ì§€','ìˆ˜','í™”','í’'];
  const makeRow=(team,i,type)=>`
    <div class='unit-row ${type==="ìºë¦­í„°"?"unit-char":"unit-pet"}'>
      <input id='${team}_atk_${i}' placeholder='ê³µ'>
      <input id='${team}_def_${i}' placeholder='ë°©'>
      <input id='${team}_spd_${i}' placeholder='ìˆœ'>
      <input id='${team}_hp_${i}' placeholder='ì²´'>
      <select id='${team}_e1_${i}'>${attrs.map(a=>`<option>${a}</option>`).join('')}</select>
      <input id='${team}_e1v_${i}' placeholder='ì†ì„±1ê°’'>
      <select id='${team}_e2_${i}'>${attrs.map(a=>`<option>${a}</option>`).join('')}</select>
      <input id='${team}_e2v_${i}' placeholder='ì†ì„±2ê°’'>
      <select><option>${type}</option></select>
    </div>`;
  ["A","B"].forEach(prefix=>{
    const container=document.getElementById(prefix==="A"?"teamA":"teamB");
    container.innerHTML="";
    for(let p=0;p<5;p++){
      const iC=p*2,iP=p*2+1;
      container.insertAdjacentHTML("beforeend",`
        <div class='unit-pair'>
          <div class='unit-label'>${p+1}ï¸âƒ£ ìºë¦­í„° â€” ğŸ¾ í˜íŠ¸</div>
          <div class='pair-line'></div>
          ${makeRow(prefix,iC,"ìºë¦­í„°")}
          ${makeRow(prefix,iP,"í˜íŠ¸")}
        </div>`);
    }
  });
}

function fillSampleValues(){
  const set=(id,v)=>{const el=document.getElementById(id);if(el)el.value=v;};
  for(let t of ["A","B"]){
    for(let i=0;i<10;i++){
      const isChar=i%2===0;
      set(`${t}_atk_${i}`,isChar?150:120);
      set(`${t}_def_${i}`,isChar?120:160);
      set(`${t}_spd_${i}`,isChar?180:130);
      set(`${t}_hp_${i}`,isChar?800:1000);
      set(`${t}_e1v_${i}`,6);
      set(`${t}_e2v_${i}`,4);
    }
  }
}

document.addEventListener("DOMContentLoaded",()=>{
  buildTeams();
  document.getElementById("run5v5").onclick=simulate5vs5;
  document.getElementById("fillTeams").onclick=fillSampleValues;
  document.getElementById("resetResult").onclick=resetResult;
});
</script>

<!-- âœ… í•˜ë‹¨ í‘¸í„° -->
<footer>
  Â© 2025 <strong>storazi</strong>. All rights reserved.<br>
  Licensed under the <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>.
</footer>

</body>
</html>
