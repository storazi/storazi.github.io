<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>í« ê³„ì‚°ê¸° (ê²½í—˜ì¹˜ + ì´ˆê¸°í™” ì‹œë®¬ë ˆì´í„°)</title>
<style>
:root{
  --bg:#0b1220; --panel:#121a2b; --soft:#1c2538; --ring:#24324b;
  --text:#eaf2ff; --muted:#a9b5cc; --accent:#6aa0ff;
  --ok:#36d17b; --warn:#ffbd4a; --bad:#ff6b81;
}
body{
  background:var(--bg);color:var(--text);
  font-family:Pretendard,system-ui,sans-serif;
  margin:0;padding:0;
  display:flex;flex-direction:column;align-items:center;
}
.tabs{display:flex;gap:8px;margin-top:20px;}
.tab{
  background:var(--panel);border:1px solid var(--ring);border-radius:8px;
  padding:8px 20px;cursor:pointer;color:var(--muted);font-weight:600;
}
.tab.active{background:var(--accent);color:#fff;}
.panel{
  display:none;margin-top:15px;
  background:var(--panel);border:1px solid var(--ring);
  border-radius:12px;padding:20px;width:90%;max-width:700px;
}
.panel.active{display:block;}
label{display:inline-block;width:120px;color:var(--muted);}
input{
  width:120px;padding:6px;background:var(--soft);border:1px solid var(--ring);
  border-radius:6px;color:var(--text);margin:3px 0;
}
button{
  margin-top:10px;padding:8px 16px;background:var(--accent);
  color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;
}
button:hover{filter:brightness(1.2);}
.result{margin-top:10px;color:var(--ok);font-weight:600;}
.combo-box{
  background:var(--panel);border:1px solid var(--ring);
  border-radius:12px;padding:10px;margin-top:10px;
}
.combo-box span{display:inline-block;margin-right:6px;}
.muted{color:var(--muted);}
.prob{color:var(--ok);font-weight:600;}
.petname-input{
  width:250px;font-weight:600;font-size:16px;margin-bottom:10px;
}
</style>
</head>
<body>

<h1>ğŸ¾ í« ê³„ì‚°ê¸°</h1>
<div class="tabs">
  <div class="tab active" data-tab="exp">ğŸ“˜ ê²½í—˜ì¹˜ ê³„ì‚°ê¸°</div>
  <div class="tab" data-tab="sim">ğŸ² í« ì´ˆê¸°í™” ì‹œë®¬ë ˆì´í„°</div>
</div>

<!-- ê²½í—˜ì¹˜ ê³„ì‚°ê¸° -->
<div id="exp" class="panel active">
  <h2>ğŸ“˜ ê²½í—˜ì¹˜ ê³„ì‚°ê¸°</h2>
  <label>í« ì´ë¦„</label><input id="petNameExp" placeholder="ì˜ˆ: í¬ì´ë¹„ìŠ¤"><br>
  <label>í˜„ì¬ ë ˆë²¨</label><input id="curLv" type="number" value="1"><br>
  <label>ëª©í‘œ ë ˆë²¨</label><input id="targetLv" type="number" value="30"><br>
  <label>ì „íˆ¬ë‹¹ ê²½í—˜ì¹˜</label><input id="expPerBattle" type="number" value="120"><br>
  <label>ë¶„ë‹¹ ì „íˆ¬ íšŸìˆ˜</label><input id="battlesPerMin" type="number" value="2"><br>
  <button id="calcExpBtn">ê²½í—˜ì¹˜ ê³„ì‚°</button>
  <div id="expResult" class="result"></div>
</div>

<!-- í« ì´ˆê¸°í™” ì‹œë®¬ë ˆì´í„° -->
<div id="sim" class="panel">
  <h2>ğŸ¯ í« ì´ˆê¸°í™” ì‹œë®¬ë ˆì´í„°</h2>
  <label>í« ì´ë¦„</label><input id="petNameSim" placeholder="ì˜ˆ: í¬ì´ë¹„ìŠ¤"><br>
  <button id="generateBtn">ëœë¤ ì´ˆê¸°í™”</button>
  <div id="simResult" class="result"></div>
  <div id="probOutput"></div>
</div>

<script>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ íƒ­ ì „í™˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.querySelectorAll('.tab').forEach(t=>{
  t.addEventListener('click', ()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
    t.classList.add('active');
    document.getElementById(t.dataset.tab).classList.add('active');
  });
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ê²½í—˜ì¹˜ ê³„ì‚°ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function expForLevel(lv){ return Math.pow(lv,3)*10; }

document.getElementById('calcExpBtn').addEventListener('click', ()=>{
  const name=document.getElementById('petNameExp').value||'ì´ë¦„ ì—†ëŠ” í«';
  const curLv=parseInt(document.getElementById('curLv').value);
  const targetLv=parseInt(document.getElementById('targetLv').value);
  const expPerBattle=parseInt(document.getElementById('expPerBattle').value);
  const battlesPerMin=parseInt(document.getElementById('battlesPerMin').value);
  if(targetLv<=curLv){
    document.getElementById('expResult').innerText='ëª©í‘œ ë ˆë²¨ì€ í˜„ì¬ë³´ë‹¤ ë†’ì•„ì•¼ í•©ë‹ˆë‹¤.';return;
  }
  const needExp=expForLevel(targetLv)-expForLevel(curLv);
  const needBattles=Math.ceil(needExp/expPerBattle);
  const needMinutes=needBattles/battlesPerMin;
  const hours=Math.floor(needMinutes/60);
  const minutes=Math.round(needMinutes%60);
  document.getElementById('expResult').innerHTML=`
  <b>${name}</b> Lv.${curLv} â†’ Lv.${targetLv}<br>
  í•„ìš” ê²½í—˜ì¹˜: ${needExp.toLocaleString()}<br>
  ì „íˆ¬ ìˆ˜: ${needBattles.toLocaleString()}íšŒ<br>
  ì˜ˆìƒ ì‹œê°„: ${hours}ì‹œê°„ ${minutes}ë¶„`;
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ í« ì´ˆê¸°í™” ì‹œë®¬ë ˆì´í„° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const combos=[
  {hp:47,atk:12,def:7,agi:4,total:380,grade8:57},
  {hp:45,atk:13,def:6,agi:5,total:410,grade8:46},
  {hp:45,atk:12,def:7,agi:4,total:395,grade8:42},
  {hp:47,atk:11,def:7,agi:5,total:365,grade8:39},
  {hp:47,atk:13,def:7,agi:4,total:402,grade8:71},
];

function getGlobalStats(list){
  let totalAll=0,grade8All=0;
  list.forEach(d=>{totalAll+=d.total;grade8All+=d.grade8;});
  return{totalAll,grade8All};
}

function calcComboRates(list){
  const global=getGlobalStats(list);
  return list.map(c=>{
    const localRate=c.total?c.grade8/c.total:0;
    const globalRate=global.totalAll?c.grade8/global.totalAll:0;
    return{
      ...c,
      localRate:(localRate*100).toFixed(2)+'%',
      globalRate:(globalRate*100).toFixed(3)+'%',
    };
  });
}

function randomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

function generatePet(){
  const name=document.getElementById('petNameSim').value||'ì´ë¦„ ì—†ëŠ” í«';
  const hp=randomInt(40,55);
  const atk=randomInt(10,14);
  const def=randomInt(5,8);
  const agi=randomInt(3,6);

  document.getElementById('simResult').innerHTML=`
    <b>${name}</b> ì´ˆê¸° ëŠ¥ë ¥ì¹˜<br>
    ì²´ë ¥:${hp}, ê³µê²©ë ¥:${atk}, ë°©ì–´ë ¥:${def}, ìˆœë°œë ¥:${agi}
  `;

  const rows=calcComboRates(combos);
  const global=getGlobalStats(combos);
  const out=document.getElementById('probOutput');
  out.innerHTML=`
    ì „ì²´ ê²½ìš°ì˜ ìˆ˜: ${global.totalAll.toLocaleString()} |
    ì „ì²´ 8ë“±ê¸‰ ì¼€ì´ìŠ¤: ${global.grade8All.toLocaleString()}<br><br>
  `;
  rows.forEach((r,i)=>{
    out.innerHTML+=`
      <div class="combo-box">
        <div>#${i+1}</div>
        <div>
          <span>ì²´ë ¥: ${r.hp}</span>
          <span>ê³µê²©ë ¥: ${r.atk}</span>
          <span>ë°©ì–´ë ¥: ${r.def}</span>
          <span>ìˆœë°œë ¥: ${r.agi}</span>
        </div>
        <div class="muted">
          ì¡°í•© ë‚´ ê²½ìš°ì˜ ìˆ˜: ${r.total.toLocaleString()} / 8ë“±ê¸‰: ${r.grade8.toLocaleString()}
        </div>
        <div>
          â–¶ ì¡°í•©ë³„ 8ë“±ê¸‰ í™•ë¥ : <span class="prob">${r.localRate}</span><br>
          â–¶ ì „ì²´ ëŒ€ë¹„ ë¹„ì¤‘: <span class="prob">${r.globalRate}</span>
        </div>
      </div>`;
  });
}

document.getElementById('generateBtn').addEventListener('click', generatePet);
</script>
</body>
</html>
