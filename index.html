<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>펫 경험치 & 8등급 확률 계산기</title>
<style>
:root{
  --bg:#0b1220; --panel:#121a2b; --soft:#1c2538; --ring:#24324b;
  --text:#eaf2ff; --muted:#a9b5cc; --accent:#6aa0ff;
  --ok:#36d17b; --warn:#ffbd4a; --bad:#ff6b81;
}
body{
  margin:0;background:var(--bg);color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Apple SD Gothic Neo,sans-serif;
  display:flex;flex-direction:column;align-items:center;padding:20px;
}
h1,h2{color:var(--accent);margin:10px 0;}
.panel{
  background:var(--panel);border:1px solid var(--ring);border-radius:12px;
  padding:20px;margin:10px 0;width:90%;max-width:700px;
}
label{display:inline-block;width:130px;color:var(--muted);}
input{
  width:120px;padding:6px;background:var(--soft);border:1px solid var(--ring);
  border-radius:6px;color:var(--text);margin:2px 0;
}
button{
  margin-top:10px;padding:8px 16px;background:var(--accent);
  color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;
}
button:hover{filter:brightness(1.2);}
.result{margin-top:10px;color:var(--ok);font-weight:600;}
.combo-box{
  background:var(--panel);border:1px solid var(--ring);
  border-radius:12px;padding:12px;margin-bottom:10px;
}
.combo-box span{display:inline-block;margin-right:8px;}
.muted{color:var(--muted);}
.prob{color:var(--ok);font-weight:600;}
hr{border:none;border-top:1px solid var(--ring);margin:25px 0;width:90%;}
.petname-input{
  width:250px;font-weight:600;font-size:16px;margin-bottom:10px;
}
</style>
</head>
<body>

<h1>🐾 펫 경험치 & 8등급 확률 계산기</h1>

<!-- 펫 이름 입력 -->
<div class="panel">
  <h2>🔖 펫 이름 입력</h2>
  <input id="petName" class="petname-input" placeholder="예: 포이비스" />
</div>

<!-- 경험치 계산기 -->
<div class="panel">
  <h2>📘 경험치 계산기</h2>
  <label>현재 레벨</label><input id="curLv" type="number" value="1"><br>
  <label>목표 레벨</label><input id="targetLv" type="number" value="30"><br>
  <label>전투당 경험치</label><input id="expPerBattle" type="number" value="120"><br>
  <label>분당 전투 횟수</label><input id="battlesPerMin" type="number" value="2"><br>
  <button id="calcExpBtn">경험치 계산</button>
  <div id="expResult" class="result"></div>
</div>

<hr>

<!-- 8등급 확률 계산기 -->
<div class="panel">
  <h2>🎯 8등급 확률 계산기</h2>
  <div id="probHeader" class="muted"></div>
  <div id="probOutput"></div>
</div>

<script>
/* ────────────────────────────────
   📘 경험치 계산 로직
──────────────────────────────── */
function expForLevel(lv){ return Math.pow(lv,3)*10; }

function calcExp(){
  const curLv = parseInt(document.getElementById('curLv').value);
  const targetLv = parseInt(document.getElementById('targetLv').value);
  const expPerBattle = parseInt(document.getElementById('expPerBattle').value);
  const battlesPerMin = parseInt(document.getElementById('battlesPerMin').value);
  const petName = document.getElementById('petName').value || '이름 없는 펫';

  if(targetLv <= curLv){
    document.getElementById('expResult').innerText = '목표 레벨은 현재보다 높아야 합니다.';
    return;
  }

  const needExp = expForLevel(targetLv) - expForLevel(curLv);
  const needBattles = Math.ceil(needExp / expPerBattle);
  const needMinutes = needBattles / battlesPerMin;
  const hours = Math.floor(needMinutes / 60);
  const minutes = Math.round(needMinutes % 60);

  document.getElementById('expResult').innerHTML = `
    <b>${petName}</b>이(가) Lv.${curLv} → Lv.${targetLv}로 성장하려면:<br>
    필요 경험치: ${needExp.toLocaleString()}<br>
    예상 전투 수: ${needBattles.toLocaleString()}회<br>
    예상 소요 시간: ${hours}시간 ${minutes}분
  `;
}
document.getElementById('calcExpBtn').addEventListener('click', calcExp);

/* ────────────────────────────────
   🎯 8등급 확률 계산 로직
──────────────────────────────── */
const combos = [
  {hp:47, atk:12, def:7, agi:4, total:380, grade8:57},
  {hp:45, atk:13, def:6, agi:5, total:410, grade8:46},
  {hp:45, atk:12, def:7, agi:4, total:395, grade8:42},
  {hp:47, atk:11, def:7, agi:5, total:365, grade8:39},
  {hp:47, atk:13, def:7, agi:4, total:402, grade8:71},
];

function getGlobalStats(list){
  let totalAll = 0, grade8All = 0;
  list.forEach(d=>{
    totalAll += d.total;
    grade8All += d.grade8;
  });
  return { totalAll, grade8All };
}

function calcComboRates(list){
  const global = getGlobalStats(list);
  return list.map(c=>{
    const localRate = c.total ? c.grade8 / c.total : 0;
    const globalRate = global.totalAll ? c.grade8 / global.totalAll : 0;
    return {
      ...c,
      localRate: (localRate*100).toFixed(2)+'%',
      globalRate: (globalRate*100).toFixed(3)+'%',
    };
  });
}

function renderProb(){
  const petName = document.getElementById('petName').value || '이름 없는 펫';
  const rows = calcComboRates(combos);
  const global = getGlobalStats(combos);
  const header = document.getElementById('probHeader');
  const out = document.getElementById('probOutput');

  header.innerHTML = `
    <b>${petName}</b> 기준<br>
    전체 경우의 수: <b>${global.totalAll.toLocaleString()}</b> |
    전체 8등급 케이스: <b>${global.grade8All.toLocaleString()}</b><br><br>
  `;

  out.innerHTML = '';
  rows.forEach((r,i)=>{
    out.innerHTML += `
      <div class="combo-box">
        <div>#${i+1}</div>
        <div>
          <span>체력: ${r.hp}</span>
          <span>공격력: ${r.atk}</span>
          <span>방어력: ${r.def}</span>
          <span>순발력: ${r.agi}</span>
        </div>
        <div class="muted">
          조합 내 경우의 수: ${r.total.toLocaleString()} / 8등급: ${r.grade8.toLocaleString()}
        </div>
        <div>
          ▶ 조합별 8등급 확률: <span class="prob">${r.localRate}</span><br>
          ▶ 전체 대비 비중: <span class="prob">${r.globalRate}</span>
        </div>
      </div>`;
  });
}

renderProb();
document.getElementById('petName').addEventListener('input', renderProb);
</script>
</body>
</html>
